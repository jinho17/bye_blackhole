{"ast":null,"code":"import{useRef,useEffect}from'react';import io from'./PongSocket';var t=0;var useCanvas=function useCanvas(game){var canvasRef=useRef(null);useEffect(function(){var canvas=canvasRef.current;var context=canvas?canvas.getContext('2d'):null;var animationFrameID;window.addEventListener('keydown',function(e){game.onKeyDown(e);});window.addEventListener('keyup',function(e){game.onKeyUp(e);});io.on('Up',function(e){game.onUp(e);});io.on('Down',function(e){game.onDown(e);});io.on('Stop',function(e){game.onStop(e);});io.on('Scored',function(e){game.onScored(e);});io.on('Update',function(e){game.onUpdate(e);});var render=function render(){var dt=(performance.now()-t)/1000;if(t===0)t=performance.now();else{t=performance.now();game.draw(context,dt);}animationFrameID=window.requestAnimationFrame(render);};render();return function(){window.cancelAnimationFrame(animationFrameID);};},[game]);return canvasRef;};export default useCanvas;","map":{"version":3,"sources":["/Users/jinkim/jinho_black/client/src/Pong/CanvasHook.tsx"],"names":["useRef","useEffect","io","t","useCanvas","game","canvasRef","canvas","current","context","getContext","animationFrameID","window","addEventListener","e","onKeyDown","onKeyUp","on","onUp","onDown","onStop","onScored","onUpdate","render","dt","performance","now","draw","requestAnimationFrame","cancelAnimationFrame"],"mappings":"AAAA,OAASA,MAAT,CAAiBC,SAAjB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,EAAP,KAAe,cAAf,CAIA,GAAIC,CAAAA,CAAC,CAAG,CAAR,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,IAAD,CAAgB,CAC9B,GAAMC,CAAAA,SAAS,CAAGN,MAAM,CAAoB,IAApB,CAAxB,CAGAC,SAAS,CAAC,UAAM,CACZ,GAAMM,CAAAA,MAAM,CAAGD,SAAS,CAACE,OAAzB,CACA,GAAMC,CAAAA,OAAO,CAAGF,MAAM,CAAGA,MAAM,CAACG,UAAP,CAAkB,IAAlB,CAAH,CAA6B,IAAnD,CACA,GAAIC,CAAAA,gBAAJ,CAEAC,MAAM,CAACC,gBAAP,CAAwB,SAAxB,CAAmC,SAACC,CAAD,CAAO,CAAET,IAAI,CAACU,SAAL,CAAeD,CAAf,EAAoB,CAAhE,EACAF,MAAM,CAACC,gBAAP,CAAwB,OAAxB,CAAiC,SAACC,CAAD,CAAO,CAAET,IAAI,CAACW,OAAL,CAAaF,CAAb,EAAkB,CAA5D,EAEAZ,EAAE,CAACe,EAAH,CAAM,IAAN,CAAY,SAACH,CAAD,CAAc,CAAET,IAAI,CAACa,IAAL,CAAUJ,CAAV,EAAc,CAA1C,EACAZ,EAAE,CAACe,EAAH,CAAM,MAAN,CAAc,SAACH,CAAD,CAAc,CAAET,IAAI,CAACc,MAAL,CAAYL,CAAZ,EAAgB,CAA9C,EACAZ,EAAE,CAACe,EAAH,CAAM,MAAN,CAAc,SAACH,CAAD,CAAc,CAAET,IAAI,CAACe,MAAL,CAAYN,CAAZ,EAAgB,CAA9C,EACAZ,EAAE,CAACe,EAAH,CAAM,QAAN,CAAgB,SAACH,CAAD,CAAe,CAAET,IAAI,CAACgB,QAAL,CAAcP,CAAd,EAAkB,CAAnD,EACAZ,EAAE,CAACe,EAAH,CAAM,QAAN,CAAgB,SAACH,CAAD,CAAe,CAAET,IAAI,CAACiB,QAAL,CAAcR,CAAd,EAAkB,CAAnD,EAEA,GAAMS,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACjB,GAAIC,CAAAA,EAAE,CAAG,CAACC,WAAW,CAACC,GAAZ,GAAoBvB,CAArB,EAA0B,IAAnC,CACA,GAAIA,CAAC,GAAK,CAAV,CACIA,CAAC,CAAGsB,WAAW,CAACC,GAAZ,EAAJ,CADJ,IAEK,CACDvB,CAAC,CAAGsB,WAAW,CAACC,GAAZ,EAAJ,CACArB,IAAI,CAACsB,IAAL,CAAUlB,OAAV,CAAmBe,EAAnB,EACH,CACDb,gBAAgB,CAAGC,MAAM,CAACgB,qBAAP,CAA6BL,MAA7B,CAAnB,CACH,CATD,CAUAA,MAAM,GAEN,MAAO,WAAM,CACTX,MAAM,CAACiB,oBAAP,CAA4BlB,gBAA5B,EACH,CAFD,CAGH,CA7BQ,CA6BN,CAACN,IAAD,CA7BM,CAAT,CAiCA,MAAOC,CAAAA,SAAP,CACH,CAtCD,CAwCA,cAAeF,CAAAA,SAAf","sourcesContent":["import { useRef, useEffect } from 'react';\nimport io from './PongSocket';\nimport Game, { Update } from './Game';\nimport { Scored, Moved } from './Game';\n\nlet t = 0;\n\nconst useCanvas = (game: Game) => {\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        const context = canvas ? canvas.getContext('2d') : null;\n        let animationFrameID: number;\n\n        window.addEventListener('keydown', (e) => { game.onKeyDown(e); });\n        window.addEventListener('keyup', (e) => { game.onKeyUp(e); });\n\n        io.on('Up', (e: Moved) => { game.onUp(e) });\n        io.on('Down', (e: Moved) => { game.onDown(e) });\n        io.on('Stop', (e: Moved) => { game.onStop(e) });\n        io.on('Scored', (e: Scored) => { game.onScored(e) });\n        io.on('Update', (e: Update) => { game.onUpdate(e) });\n\n        const render = () => {\n            let dt = (performance.now() - t) / 1000;\n            if (t === 0)\n                t = performance.now();\n            else {\n                t = performance.now();\n                game.draw(context, dt);\n            }\n            animationFrameID = window.requestAnimationFrame(render);\n        }\n        render();\n\n        return () => {\n            window.cancelAnimationFrame(animationFrameID);\n        };\n    }, [game]);\n\n\n\n    return canvasRef;\n}\n\nexport default useCanvas;"]},"metadata":{},"sourceType":"module"}