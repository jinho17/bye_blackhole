{"ast":null,"code":"import _slicedToArray from\"/Users/jinkim/jinho_black/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/jinkim/jinho_black/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jinkim/jinho_black/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useState}from\"react\";import axios from\"axios\";import useSwr from'swr';import lock from'../Images/lock.png';import unlock from'../Images/unlock.png';import\"./styles/ChatList.scss\";import PwdCheckModal from\"./PwdCheckModal\";import BanModal from\"./BanModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ChatList=function ChatList(props){var MyID=props.MyID;var fetcher=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(url);case 2:res=_context.sent;return _context.abrupt(\"return\",res.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetcher(_x){return _ref.apply(this,arguments);};}();var _useSwr=useSwr('Lobby/chatList',fetcher),data=_useSwr.data,error=_useSwr.error;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),ClickedRoomTitle=_useState2[0],setClickedRoomTitle=_useState2[1];//pwd check modal\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),PwdCheckModalState=_useState4[0],setPwdCheckModalState=_useState4[1];var openPwdCheckModal=function openPwdCheckModal(title){setPwdCheckModalState(true);setClickedRoomTitle(title);};var closePwdCheckModal=function closePwdCheckModal(){setPwdCheckModalState(false);};//ban modal\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),BanModalState=_useState6[0],setBanModalState=_useState6[1];var closeBanModal=function closeBanModal(){setBanModalState(false);};function enterPublicRoom(_x2){return _enterPublicRoom.apply(this,arguments);}function _enterPublicRoom(){_enterPublicRoom=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(title){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/Lobby/enter',{title:title,id:MyID,password:''}).then(function(res){document.location.href='/Chat';sessionStorage.setItem('roomName',title);}).catch(function(err){//ban modal 띄우기\nsetBanModalState(true);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _enterPublicRoom.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[data===null||data===void 0?void 0:data.map(function(chatRoom){return/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"chatList\",onClick:function onClick(){if(chatRoom.security==='protected')openPwdCheckModal(chatRoom.title);else enterPublicRoom(chatRoom.title);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"chatList-left\",children:/*#__PURE__*/_jsx(\"div\",{className:\"chatList-num\",children:chatRoom.num})}),/*#__PURE__*/_jsx(\"span\",{className:\"lock\",children:chatRoom.security!=\"protected\"?/*#__PURE__*/_jsx(\"img\",{src:unlock,width:\"20\",height:\"20\"}):/*#__PURE__*/_jsx(\"img\",{src:lock,width:\"20\",height:\"20\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"roomName\",children:chatRoom.title})]});}),/*#__PURE__*/_jsx(PwdCheckModal,{open:PwdCheckModalState,close:closePwdCheckModal,chatRoomID:ClickedRoomTitle,MyID:MyID}),/*#__PURE__*/_jsx(BanModal,{open:BanModalState,close:closeBanModal})]});};export default ChatList;","map":{"version":3,"sources":["/Users/jinkim/jinho_black/client/src/Lobby/ChatList.tsx"],"names":["useState","axios","useSwr","lock","unlock","PwdCheckModal","BanModal","ChatList","props","MyID","fetcher","url","get","res","data","error","ClickedRoomTitle","setClickedRoomTitle","PwdCheckModalState","setPwdCheckModalState","openPwdCheckModal","title","closePwdCheckModal","BanModalState","setBanModalState","closeBanModal","enterPublicRoom","post","id","password","then","document","location","href","sessionStorage","setItem","catch","err","map","chatRoom","security","num"],"mappings":"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","sourcesContent":["import {useEffect, useState, useCallback} from \"react\";\nimport axios from \"axios\";\nimport useSwr from 'swr';\nimport lock from '../Images/lock.png'\nimport unlock from '../Images/unlock.png'\nimport \"./styles/ChatList.scss\"\nimport PwdCheckModal from \"./PwdCheckModal\";\nimport BanModal from \"./BanModal\";\n\nconst ChatList = (props: any) => {\n\tconst {MyID} = props\n\n\tconst fetcher = async (url:string) => {\n\t\tconst res = await axios.get(url)\n\t\treturn res.data;\n\t}\n\n\tconst {data, error} = useSwr<{title:string, num:number, security:string}[]>('Lobby/chatList', fetcher)\n\n\tconst [ClickedRoomTitle, setClickedRoomTitle] = useState('')\n\t//pwd check modal\n\tconst [PwdCheckModalState, setPwdCheckModalState] = useState(false);\n\tconst openPwdCheckModal = (title:string) => {\n\t\tsetPwdCheckModalState(true);\n\t\tsetClickedRoomTitle(title)\n\t}\n\tconst closePwdCheckModal = () => {\n\t\tsetPwdCheckModalState(false);\n\t}\n\n\t//ban modal\n\tconst [BanModalState, setBanModalState] = useState(false);\n\tconst closeBanModal = () => {\n\t\tsetBanModalState(false);\n\t}\n\n\tasync function enterPublicRoom(title:string) {\n\t\tawait axios.post('/Lobby/enter', {title:title, id:MyID, password:''})\n\t\t.then((res) => {\n\t\t\tdocument.location.href = '/Chat';\n\t\t\tsessionStorage.setItem('roomName', title)\n\t\t})\n\t\t.catch((err) => {\n\t\t\t//ban modal 띄우기\n\t\t\tsetBanModalState(true);\n\t\t})\n\t}\n\n\treturn (\n\t<>\n\t{data?.map(chatRoom=>\n\t\t<button type=\"button\" className=\"chatList\" onClick={() => {\n\t\t\tif (chatRoom.security === 'protected')\n\t\t\t\topenPwdCheckModal(chatRoom.title)\n\t\t\telse\n\t\t\t\tenterPublicRoom(chatRoom.title)\n\t\t}}>\n\t\t\t<span className=\"chatList-left\">\n\t\t\t\t<div className=\"chatList-num\">{chatRoom.num}</div>\n\t\t\t</span>\n\t\t\t<span className=\"lock\">\n\t\t\t\t{chatRoom.security != \"protected\" ? <img src={unlock} width=\"20\" height=\"20\"/> : <img src={lock} width=\"20\" height=\"20\"/>}\n\t\t\t</span>\n\t\t\t<span className=\"roomName\">\n\t\t\t\t{chatRoom.title}\n\t\t\t</span>\n\n\t\t</button>\n\t)}\n\t<PwdCheckModal open={PwdCheckModalState} close={closePwdCheckModal} chatRoomID={ClickedRoomTitle} MyID={MyID} />\n\t<BanModal open={BanModalState} close={closeBanModal}/>\n\t</>\n\t)\n}\n\nexport default ChatList"]},"metadata":{},"sourceType":"module"}